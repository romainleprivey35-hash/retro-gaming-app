<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ma Collection Retro - Romain</title>
    <style>
        body { background: #121212; color: white; font-family: 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 15px; }
        
        h1 { text-align: center; color: #00ff88; font-size: 1.5rem; text-transform: uppercase; margin-bottom: 25px; }

        /* Grille adaptative */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); /* 2 colonnes par dÃ©faut (Mobile) */
            gap: 15px; 
        }

        /* Si l'Ã©cran est plus large que 600px (Tablette/PC) */
        @media (min-width: 600px) {
            .grid { grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); }
        }

        .card { 
            background: #222; border-radius: 15px; padding: 12px; text-align: center;
            border: 1px solid #333; position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .not-owned { opacity: 0.25; filter: grayscale(100%); }

        /* Taille des images adaptÃ©e au mobile */
        .img-container { 
            width: 100%; 
            height: 180px; 
            display: flex; align-items: center; justify-content: center; 
            margin-bottom: 10px; background: #1a1a1a; border-radius: 10px; overflow: hidden; 
        }
        img { max-width: 100%; max-height: 100%; object-fit: contain; }

        .title { font-weight: bold; font-size: 0.85rem; height: 35px; line-height: 1.2; overflow: hidden; color: #fff; margin-bottom: 5px; }
        .price { color: #00ff88; font-weight: bold; font-family: 'Courier New', monospace; font-size: 1.1rem; }
    </style>
</head>
<body>
    <h1>ðŸŽ® Ma Collection</h1>
    <div id="app" class="grid">Chargement...</div>

    <script>
        const SHEET_ID = '1Vw439F_75oc7AcxkDriWi_fwX2oBbAejnp-f_Puw-FU'; 
        const SHEET_NAME = 'Jeux';

        function getDirectImg(url) {
            if (!url || !url.includes('id=')) return url;
            const id = url.split('id=')[1].split('&')[0];
            return `https://drive.google.com/thumbnail?id=${id}&sz=w500`; // Thumbnail plus rapide Ã  charger
        }

        async function fetchSheet() {
            const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`;
            try {
                const response = await fetch(url);
                const text = await response.text();
                const json = JSON.parse(text.substr(47).slice(0, -2));
                const rows = json.table.rows;
                
                let html = '';
                rows.forEach(row => {
                    const titre = row.c[0] ? row.c[0].v : 'Sans titre'; 
                    const rawPhoto = row.c[6] ? row.c[6].v : '';        
                    const cote = row.c[12] ? row.c[12].v : '--';         
                    const possede = row.c[14] ? row.c[14].v : '';        

                    const photoUrl = getDirectImg(rawPhoto);
                    const isOwned = (possede && possede.includes("Oui"));
                    const classOwned = isOwned ? "" : "not-owned";

                    html += `
                        <div class="card ${classOwned}">
                            <div class="img-container">
                                <img src="${photoUrl}" alt="${titre}" loading="lazy" onerror="this.src='https://via.placeholder.com/150x200?text=Image'">
                            </div>
                            <div class="title">${titre}</div>
                            <div class="price">${cote} â‚¬</div>
                        </div>
                    `;
                });
                document.getElementById('app').innerHTML = html;
            } catch (e) {
                document.getElementById('app').innerHTML = "Erreur de connexion.";
            }
        }
        fetchSheet();
    </script>
</body>
</html>
